{% extends "base.html" %}

{% block title %}Purchase Order{% endblock %}

{% block content %}

<!-- Modal account type -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Create Account Type</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <input
            type="text"
            id="accountType"
            name="accountType"
            class="form-control"
            placeholder="Account Type"
            aria-label="Username"
            aria-describedby="basic-addon1"
          />
        </div>
        <div class="input-group mb-3">
          <input
            type="text"
            id="status"
            name="status"
            class="form-control"
            placeholder="Status"
            aria-label="Username"
            aria-describedby="basic-addon1"
          />
        </div>
        <div class="d-flex justify-content-end w-100">
          <button type="button" class="btn btn-success" id="saveAccountType">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal edit purchase 1212 -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  id="modalChangePassword"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalEdit">Edit Purchase Order</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <h5 id="error-message-password-edit" style="display: none">
          Please fill up correctly.
        </h5>
        <label id="error-message-password-edit" class="fw-bold">
          Item Id:
        </label>
        <div class="dropdown">
          <button
            class="btn btn-secondary dropdown-toggle mb-2"
            type="button"
            id="accountTypeButtonEdit"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Code ID
          </button>
          <ul class="dropdown-menu" aria-labelledby="accountTypeButton" style="max-height: 200px; overflow-y: auto;">
            {% for code, data in code_id.items() %}
            <li>
              <a class="dropdown-item" href="#" onclick="updateButtonTextEdit('{{ code }}', '{{ data.price }}', '{{ data.quantity }}')">
                {{ code }}
              </a>
            </li>
            {% else %}
            <li>
              <a class="dropdown-item" href="#" onclick="updateButtonTextEdit('No account types found', '')">
                No account types found
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
        <div class="input-group mb-3">
          <span style="font-weight: 700">Item Quantity:</span>
          <div class="input-group">
            <input
              type="text"
              id="editItemQuantity"
              name="quantity"
              class="form-control"
              placeholder="Item Quantity"
              aria-label="Username"
              aria-describedby="basic-addon1"
              disabled
            />
          </div>
        </div>
        <div class="input-group mb-3">
          <span style="font-weight: 700">Price Per Unit:</span>
          <div class="input-group">
            <input
              type="text"
              id="editPricePerUnit"
              name="quantity"
              class="form-control"
              placeholder="Password"
              aria-label="Username"
              aria-describedby="basic-addon1"
              disabled
            />
          </div>
        </div>
        <div class="input-group mb-3">
          <span style="font-weight: 700">Description:</span>
          <div class="input-group">
            <input
              type="text"
              id="editDescription"
              name="quantity"
              class="form-control"
              placeholder="Description"
              aria-label="Username"
              aria-describedby="basic-addon1"
            />
          </div>
        </div>
        <div class="input-group mb-3">
          <span style="font-weight: 700">Quantity</span>
          <div class="input-group">
            <input
              type="text"
              id="editQuantity"
              name="editQuantity"
              class="form-control"
              placeholder="Quantity"
              aria-label="Username"
              aria-describedby="basic-addon1"  
            />
          </div>
        </div>
        <div class="input-group mb-3">
          <span style="font-weight: 700">Total Price</span>
          <div class="input-group">
            <input
              type="text"
              id="EditTotalPrice"
              name="quantity"
              class="form-control"
              placeholder="Total Price"
              aria-label="Username"
              aria-describedby="basic-addon1"
              disabled
            />
          </div>
        </div>
        <div class="d-flex justify-content-end w-100">
          <button type="button" class="btn btn-success" id="saveEditPurchaseOrder">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal user -->
<div
  class="modal fade"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  id="createUser"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Purchase Order</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <h3 id="error-message" style="display: none">Please fill up correctly</h3>
        <!-- Dropdown for account type -->
        <div class="dropdown">
          <button
            class="btn btn-secondary dropdown-toggle"
            type="button"
            id="accountTypeButton"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Code ID
          </button>
          <ul class="dropdown-menu" aria-labelledby="accountTypeButton" style="max-height: 200px; overflow-y: auto;">
            {% for code, data in code_id.items() %}
            <li>
              <a class="dropdown-item" href="#" onclick="updateButtonText('{{ code }}', '{{ data.price }}', '{{ data.quantity }}')">
                {{ code }}
              </a>
            </li>
            {% else %}
            <li>
              <a class="dropdown-item" href="#" onclick="updateButtonText('No account types found', '')">
                No account types found
              </a>
            </li>
            {% endfor %}
          </ul>
        </div>
        
        <!-- Input for Price/Unit -->
        <div class="mb-3 gap-2 mt-4">
          <label class="fw-bold  mb-1" for="pricePerUnit">Item Quantity</label>
          <input
            type="text"
            id="itemQuantity"
            name="itemQuantity"
            class="form-control"
            placeholder="Item Quantity"
            aria-label="PricePerUnit"
            aria-describedby="basic-addon1"
            disabled
          />
        </div>
        <div class="mb-3 gap-2 mt-4">
          <label class="fw-bold  mb-1" for="pricePerUnit">Price per Unit</label>
          <input
            type="text"
            id="pricePerUnit"
            name="pricePerUnit"
            class="form-control"
            placeholder="Price Per Unit"
            aria-label="PricePerUnit"
            aria-describedby="basic-addon1"
            disabled
          />
        </div>
        

        <div class=" mb-3 gap-2">
          <label class="fw-bold mb-1" for="">Description</label>
          <input
            type="text"
            id="description"
            name="description"
            class="form-control"
            placeholder="Description"
            aria-label="Username"
            aria-describedby="basic-addon1"
          />
        </div>
        <div class=" mb-3 gap-2">
          <label class="fw-bold mb-1" for="">Quantity</label>
          <input
            type="text"
            id="quantity"
            name="quantity"
            class="form-control"
            placeholder="Quantity"
            aria-label="Username"
            aria-describedby="basic-addon1"
          />
        </div>
        <div class=" mb-3 gap-2">
          <label class="fw-bold mb-1" for="">Total Price</label>
          <input
            type="text"
            id="totalPrice"
            name="totalPrice"
            class="form-control"
            placeholder="Total Price"
            aria-label="Username"
            aria-describedby="basic-addon1"
            disabled
          />
        </div>
        <div class="d-flex justify-content-end w-100">
          <button type="button" class="btn btn-success" id="savePurchaseOrder">
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="">
  <div class="d-flex justify-content-between w-100">
    <h1>Purchase Order</h1>
    <button
      type="button"
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#createUser"
    >
      Add Purchase Order
    </button>
  </div>
  
  <!-- Search Bar -->
  
  <div class="container">
    <div class="mb-3 mt-5 d-flex flex-row align-items-center">
      <label for="searchInput" class="me-2">Search</label>
      <input 
        type="text" 
        class="form-control" 
        id="searchInput" 
        placeholder="Search users..." 
        style="max-width: 10rem;"
      >
    </div>
    {% if logs %}
    <table class="table mt-3" id="usersTable">
      <thead>
        <tr>
          <th></th>
          <th>Item Code</th>
          <th>Description</th>
          <th>Price Per Unit</th>
          <th>Quantity</th>
          <th>Total Price</th>
        </tr>
      </thead>
      <tbody>
        {% for log in logs %}
        <tr
          data-id="{{ log[0] }}"
          data-code-id="{{ log[1] }}"
          data-Description="{{ log[2] }}"
          data-price-per-unit="{{ log[6] }}"
          data-quantity="{{ log[4] }}"
          data-total-price="{{ log[3] }}"
          data-left-item-quantity="{{ log[7] }}"
        >
          <td>
            <div>
              <button
                type="button"
                class="btn btn-warning edit-btn"
                data-bs-toggle="modal"
                data-bs-target="#modalChangePassword"
              >
              <i class="bi bi-pencil-square"></i>
              </button>
              <!-- <button
              type="button"
              class="btn btn-primary ViewPurchaseOrder"
              data-bs-toggle="modal"
              data-bs-target="#modalChangePassword"
            >
            <i class="bi bi-eye-fill"></i>
            </button> -->
              <!-- <button type="button" class="btn btn-danger" id="deactivation">
                <i class="bi bi-x-circle-fill"></i>
              </button> -->
            </div>
          </td>
          <td>{{ log[1] }}</td>
          <td>{{ log[2] }}</td>
          <td>{{ log[6] }}</td>
          <td>{{ log[4] }}</td>
          <td>{{ log[3] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    
    <!-- Pagination -->
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center" id="pagination">
          <!-- Pagination links will be added by JavaScript -->
      </ul>
  </nav>
    
    {% else %}
    <p>No logs found.</p>
    {% endif %}
  </div>
</div>

<!-- Include jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<!-- Bootstrap JS (includes Popper.js) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript to update button text -->
<script>
  function updateButtonText(selectedCode, selectedPrice,itemQuantity) {
    // Update the button text with the selected Code ID
    document.getElementById("accountTypeButton").innerText = selectedCode;

    // Update the disabled Price per Unit input
    document.getElementById("pricePerUnit").value = selectedPrice;
    document.getElementById("itemQuantity").value = itemQuantity;

    // Trigger total price calculation if quantity is already entered
    calculateTotalPrice();
  }

  function calculateTotalPrice() {
    let price = parseFloat(document.getElementById("pricePerUnit").value) || 0;
    let quantity = parseFloat(document.getElementById("quantity").value) || 0;
    let totalPrice = price * quantity;

    document.getElementById("totalPrice").value = totalPrice.toFixed(2); // Ensures two decimal places
  }

  // Attach event listener to Quantity field
  document.getElementById("quantity").addEventListener("input", calculateTotalPrice);
</script>

<!-- JavaScript to update button text -->
<script>
  var editedquantity;
  function updateButtonTextEdit(selectedCode, selectedPrice,itemQuantity) {
    // Update the button text with the selected Code ID
    document.getElementById("accountTypeButtonEdit").innerText = selectedCode;

    // Update the disabled Price per Unit input
    document.getElementById("editPricePerUnit").value = selectedPrice;
    document.getElementById("editItemQuantity").value = itemQuantity;

    // Trigger total price calculation if quantity is already entered
    calculateTotalPriceEdit();
  }

  function calculateTotalPriceEdit() {
    let price = parseFloat(document.getElementById("editPricePerUnit").value) || 0;
    let quantity = parseFloat(document.getElementById("editQuantity").value) || 0;
    let totalPrice = price * quantity;

    document.getElementById("EditTotalPrice").value = totalPrice.toFixed(2); // Ensures two decimal places
  }

  // Attach event listener to Quantity field
  document.getElementById("editQuantity").addEventListener("input", calculateTotalPriceEdit);
</script>



<!-- JavaScript for AJAX, pagination, and search functionality -->
<script type="text/javascript">
$(document).ready(function() {
    // Initialize variables
    var rowsPerPage = 10;
    var $table = $('#usersTable');
    var $tbody = $table.find('tbody');
    var $originalRows = $tbody.find('tr');
    var $rows = $originalRows;
    var totalRows = $rows.length;
    var pageCount = Math.ceil(totalRows / rowsPerPage);
    var currentPage = 1;
    var maxVisiblePages = 6; // Maximum number of visible page buttons
    
    // Create a no results row
    var $noResults = $('<tr><td colspan="5" class="text-center">No results found</td></tr>');
    
    // Function to initialize pagination
    function initPagination() {
        var $pagination = $('#pagination');
        $pagination.empty();
        
        // Add Previous button
        $pagination.append('<li class="page-item"><a class="page-link" href="#" id="prevPage">&laquo;</a></li>');
        
        // Calculate range of pages to show
        var startPage, endPage;
        if (pageCount <= maxVisiblePages) {
            startPage = 1;
            endPage = pageCount;
        } else {
            var maxPagesBeforeCurrent = Math.floor(maxVisiblePages / 2);
            var maxPagesAfterCurrent = Math.ceil(maxVisiblePages / 2) - 1;
            
            if (currentPage <= maxPagesBeforeCurrent) {
                startPage = 1;
                endPage = maxVisiblePages;
            } else if (currentPage + maxPagesAfterCurrent >= pageCount) {
                startPage = pageCount - maxVisiblePages + 1;
                endPage = pageCount;
            } else {
                startPage = currentPage - maxPagesBeforeCurrent;
                endPage = currentPage + maxPagesAfterCurrent;
            }
        }
        
        // Add first page with ellipsis if needed
        if (startPage > 1) {
            $pagination.append('<li class="page-item"><a class="page-link" href="#">1</a></li>');
            if (startPage > 2) {
                $pagination.append('<li class="page-item disabled"><span class="page-link">...</span></li>');
            }
        }
        
        // Add page numbers in range
        for (var i = startPage; i <= endPage; i++) {
            var activeClass = i === currentPage ? ' active' : '';
            $pagination.append(
                '<li class="page-item' + activeClass + '"><a class="page-link" href="#">' + i + '</a></li>'
            );
        }
        
        // Add last page with ellipsis if needed
        if (endPage < pageCount) {
            if (endPage < pageCount - 1) {
                $pagination.append('<li class="page-item disabled"><span class="page-link">...</span></li>');
            }
            $pagination.append('<li class="page-item"><a class="page-link" href="#">' + pageCount + '</a></li>');
        }
        
        // Add Next button
        $pagination.append('<li class="page-item"><a class="page-link" href="#" id="nextPage">&raquo;</a></li>');
        
        // Show stored page or first page by default
        var storedPage = localStorage.getItem('usersCurrentPage');
        if (storedPage && storedPage <= pageCount) {
            currentPage = parseInt(storedPage);
        }
        showPage(currentPage);
    }
    
    // Load stored search term if exists
    var storedSearch = localStorage.getItem('usersLastSearch');
    if (storedSearch) {
        $('#searchInput').val(storedSearch);
        performSearch(storedSearch);
    } else {
        initPagination();
    }
    
    // Pagination click handlers
    $('#pagination').on('click', 'a.page-link:not(#prevPage):not(#nextPage)', function(e) {
        e.preventDefault();
        currentPage = parseInt($(this).text());
        localStorage.setItem('usersCurrentPage', currentPage);
        showPage(currentPage);
        initPagination(); // Rebuild pagination to center on current page
    });
    
    $('#prevPage').on('click', function(e) {
        e.preventDefault();
        if (currentPage > 1) {
            currentPage--;
            localStorage.setItem('usersCurrentPage', currentPage);
            showPage(currentPage);
            initPagination();
        }
    });
    
    $('#nextPage').on('click', function(e) {
        e.preventDefault();
        if (currentPage < pageCount) {
            currentPage++;
            localStorage.setItem('usersCurrentPage', currentPage);
            showPage(currentPage);
            initPagination();
        }
    });
    
    // Search functionality
    $('#searchInput').on('keyup', function() {
        var searchText = $(this).val().toLowerCase();
        localStorage.setItem('usersLastSearch', searchText);
        performSearch(searchText);
    });
    
    // Function to perform search
    function performSearch(searchText) {
        // Remove no results row if it exists
        $noResults.detach();
        
        if (searchText === '') {
            // If search is empty, reset to original state
            localStorage.removeItem('usersLastSearch');
            $rows = $originalRows;
            totalRows = $rows.length;
            pageCount = Math.ceil(totalRows / rowsPerPage);
            currentPage = 1;
            initPagination();
            return;
        }
        
        // Filter rows
        var hasResults = false;
        $rows = $originalRows.filter(function() {
            var rowText = $(this).text().toLowerCase();
            var isMatch = rowText.indexOf(searchText) > -1;
            if (isMatch) hasResults = true;
            return isMatch;
        });
        
        totalRows = $rows.length;
        pageCount = Math.ceil(totalRows / rowsPerPage);
        currentPage = 1;
        
        // Show no results message if no matches
        if (!hasResults) {
            $tbody.append($noResults);
        }
        
        // Reinitialize pagination with filtered results
        initPagination();
    }
    
    // Function to show specific page
    function showPage(pageNum) {
        var startIndex = (pageNum - 1) * rowsPerPage;
        var endIndex = startIndex + rowsPerPage;
        
        // Hide all rows
        $originalRows.hide();
        
        // Show either the no results message or the paginated rows
        if ($noResults.is(':visible')) {
            $noResults.show();
        } else {
            $rows.slice(startIndex, endIndex).show();
        }
        
        // Update active page in pagination
        $('#pagination').find('li').removeClass('active');
        $('#pagination').find('a').each(function() {
            if ($(this).text() == pageNum && !$(this).is('#prevPage, #nextPage')) {
                $(this).parent().addClass('active');
            }
        });
        
        // Enable/disable Previous and Next buttons
        $('#prevPage').parent().toggleClass('disabled', pageNum <= 1);
        $('#nextPage').parent().toggleClass('disabled', pageNum >= pageCount);
    }
});


  $(document).on("click", "#saveEditPurchaseOrder", function (event) {
    var editItemQuantity = $.trim($("#editItemQuantity").val());
    var editPricePerUnit = $.trim($("#editPricePerUnit").val());
    var editDescription = $.trim($("#editDescription").val());
    var editQuantity = $.trim($("#editQuantity").val());
    var EditTotalPrice = $.trim($("#EditTotalPrice").val());
    var accountTypeButton = $.trim($("#accountTypeButtonEdit").text());
    var id = $("#modalChangePassword").attr("data-itemId");
    console.log(id);
    console.log(accountTypeButton);
    console.log("editItemQuantity:", editItemQuantity);
    console.log("editPricePerUnit:", editPricePerUnit);
    console.log("editDescription:", editDescription);
    console.log("editQuantity:", editQuantity);
    console.log("EditTotalPrice:", EditTotalPrice);
    editItemQuantity
    var isOk = 0;
    if (editDescription == "") {
      isOk++;
      console.log(isOk);
    }
    if (editItemQuantity == 0) {
      isOk++;
  $("#error-message-password-edit").css({
    display: "block",
    color: "red",
  }).text("Low Item quantity"); // Add the text message here
  console.log(isOk);
}
    const regex = /^\d+$/; // Only allows numbers
    if (!regex.test(editQuantity)) { 
      console.log('regex')
      isOk++; 
      console.log(isOk); 
    }

    if (isOk > 0) {
      $("#error-message-password-edit").css({
    display: "block",
    color: "red",
  }).text("Please fill up correctly."); // Add the text message here
      isOk = 0;
      setTimeout(function () {
        $("#error-message-password-edit").css({
          display: "none",
          color: "red",
        });
      }, 4000);
    } else {
      $.ajax({
        url: "{{url_for('purchaseOrderEdit')}}",
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify({
          id: id,
          accountTypeButton: accountTypeButton,
          editItemQuantity:editItemQuantity,
          editPricePerUnit:editPricePerUnit,
          editDescription:editDescription,
          editQuantity:editQuantity,
          EditTotalPrice:EditTotalPrice,

        }),
        success: function (response) {
          setTimeout(function () {
            location.reload();
          }, 500);
          console.log(response);
        },
        error: function (error) {
          console.log(error);
        },
      });
    }
  });

  $(document).on("click", ".edit-btn", function () {
    var row = $(this).closest("tr");
    var code_id = row.data("code-id");
    var pricePerUnit = row.data("price-per-unit");
    var leftItemQuantity = row.data("left-item-quantity");
    var id = row.data("id");
    editItemQuantity
    document.getElementById("accountTypeButtonEdit").innerText = code_id;
    document.getElementById("editPricePerUnit").value = pricePerUnit;
    document.getElementById("editItemQuantity").value = leftItemQuantity;
    $("#modalChangePassword").attr("data-itemId", id);
  });

  // $(document).on("click", "#deactivation", function (event) {
  //   var row = $(this).closest("tr");
  //   var id = row.data("id");
  //   var codeId = row.data("fullname");
  //   console.log(codeId);
  //   console.log(id);
  //   $.ajax({
  //     url: "{{url_for('userDeactivation')}}",
  //     type: "POST",
  //     contentType: "application/json",
  //     data: JSON.stringify({
  //       id: id,
  //       codeId: codeId,
  //     }),
  //     success: function (response) {
  //       setTimeout(function () {
  //         location.reload();
  //       }, 500);
  //       console.log(response);
  //     },
  //     error: function (error) {
  //       console.log(error);
  //     },
  //   });
  // });

  $(document).on("click", "#savePurchaseOrder", function (event) {
    var pricePerUnit = $.trim($("#pricePerUnit").val());
    var description = $.trim($("#description").val());
    var quantity = $.trim($("#quantity").val());
    var accountTypeButton = $.trim($("#accountTypeButton").text());
    var totalPrice = $.trim($("#totalPrice").val());
    var itemQuantity = $.trim($("#itemQuantity").val());
    var leftItemQuantity = Number(itemQuantity) - Number(quantity)

    console.log(pricePerUnit)
    console.log(description)
    console.log(quantity)
    console.log(accountTypeButton)
    console.log(totalPrice)
    var isOk = 0;
    if (editItemQuantity == 0) {
      isOk++;
  $("#error-message").css({
    display: "block",
    color: "red",
  }).text("Low Item quantity"); // Add the text message here
  console.log(isOk);
}
    // Regular expression to check if the value is not a number
    if (accountTypeButton == "Code ID" || accountTypeButton == "No account types found" ) {
      console.log('INSIDEaccountTypeButton')
      isOk++;
      console.log(isOk);
    }
    if (pricePerUnit == "") {
      console.log('INSIDE pricePerUnit')
      isOk++;
      console.log(isOk);
    }
      if (Number(itemQuantity) < Number(quantity)) {
    console.log('INSIDE CHECK QUAN malaki');
    isOk++;
    console.log(isOk);
  }
    if (description == "") {
      console.log('INSIDEdescription')
      isOk++;
      console.log(isOk);
    }
    const regex = /^\d+$/; // Only allows numbers
    if (!regex.test(quantity)) { 
      console.log('regex')
      isOk++; 
      console.log(isOk); 
    }

    if (isOk > 0) {
      $("#error-message").css({
        display: "block",
        color: "red",
      }).text("Please fill up correctly."); // Add the text message here
      isOk = 0;
      setTimeout(function () {
        $("#error-message").css({
          display: "none",
          color: "red",
        });
      }, 4000);
    } 
    else {
      $.ajax({
        url: "{{url_for('createPurchaseOrder')}}",
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify({
          pricePerUnit: pricePerUnit,
          description: description,
          quantity: quantity,
          code_id: accountTypeButton,
          totalPrice:totalPrice,
          leftItemQuantity:leftItemQuantity
        }),
        success: function (response) {
          setTimeout(function () {
            location.reload();
          }, 500);
          console.log(response);
        },
        error: function (error) {
          console.log(error);
        },
      });
    }
  });
</script>
{% endblock %}